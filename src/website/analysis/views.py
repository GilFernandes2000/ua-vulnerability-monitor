from django.shortcuts import render
from django.http import JsonResponse
import requests
import subprocess
import urllib
import json
from rest_framework.response import Response
from rest_framework.decorators import api_view
from django.views.decorators.csrf import csrf_exempt

from .manageDB import updateDB

@api_view(['POST'])
@csrf_exempt
def results(request):
    data = request.data

    with open('analysis/domains.json', 'w') as f:
        json.dump(data, f, indent=4)

    updateDB()

    return JsonResponse(data)