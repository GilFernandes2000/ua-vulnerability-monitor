USE IP_CVE_Bank;
GO

INSERT INTO Project.Department(id, name) VALUES ('4','DETI'),
('23','CP')

INSERT INTO Project.Machine(id, IP_address,Machine_User,Machine_Owner,Sofware,Sofware_version,FK_Department) VALUES 
('1','193.0.0.1','Ramalho Costa','Ramalho Costa','Ubuntu','20.04 LTS','4'),
('2','193.0.0.2','Pedro Ferreira','Ramalho Costa','Ubuntu','20.04 LTS','4'),
('3','193.0.0.3','Joao Paulo Barraca','Joao Paulo Barraca','Ubuntu','20.04 LTS','4'),
('4','193.0.0.4','Diana Ribeiro','Joao Paulo Barraca','Windows 11','21H2','23'),
('5','10.198.1.5','Tiago Pedrosa','Joao Fernandes','Xubuntu','21.10','4'),
('6','10.198.2.8','Ana Filipe','Joao Fernandes','Windows 11','21H2','4');

SET ANSI_WARNINGS OFF;
INSERT INTO Project.CVE(CVE_id,CVSS,descript) VALUES ('CVE-2021-43907','10.0','Very Bad'),
('CVE-2021-43243','2.1','Partial Confidentiality impact, esitly solved by blablabla'),
('CVE-2021-43238','6.8','Modification of some system files or information is possible, but the attacker does not have control over what can be modified, or the scope of what the attacker can affect is limited.'),
('CVE-2019-1481','4.3','An information disclosure vulnerability exists in Windows Media Player when it fails to properly handle objects in memory, aka Windows Media Player Information Disclosure Vulnerability. This CVE ID is unique from CVE-2019-1480.'),
('CVE-2019-1462','9.3','A remote code execution vulnerability exists in Microsoft PowerPoint software when the software fails to properly handle objects in memory');
SET ANSI_WARNINGS ON;

INSERT INTO Project.Machine_Vuln(FK_Machine,FK_CVE,detection_date) VALUES 
('1','CVE-2021-43243','27/01/2020'),
('2','CVE-2019-1462','27/01/2021'),
('3','CVE-2021-43907','27/01/2021'),
('4','CVE-2021-43907','27/01/2021'),
('4','CVE-2021-43238','27/01/2021'),
('4','CVE-2019-1481','27/01/2020'),
('5','CVE-2021-43243','27/01/2021'),
('6','CVE-2021-43243','27/01/2021');

select * from Project.Machine
select * from Project.CVE
select * from Project.Machine_Vuln
select * from Project.Department